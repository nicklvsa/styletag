const TAGGED_ATTR="tagged",useStyleTag=t=>{const e={},r=t=>(t&&""!==t||(t="elem"),`${t}_${Math.random().toString(36).substr(2,9)}`),s=t=>{const e=[];return(t=t.replace("\n","").trim()).match(/[\#\.\w\-\,\s\n\r\t:]+(?=\s*\{)/g).forEach(t=>{e.push(t.trim())}),e},o=t=>{const e=t.split("");return e.forEach((t,r)=>{"-"===t&&(e[r+1]=e[r+1].toUpperCase(),e[r]=null)}),e.join("")},n=document.querySelectorAll("style");for(let t=0;t<n.length;t++){const o=n[t];o.hasAttribute("tagged")&&(n[t].setAttribute("tagged",r("tagged")),e[o.getAttribute("tagged")]=s(o.textContent))}const c=document.querySelectorAll("link");for(let t=0;t<c.length;t++){const o=c[t];o.hasAttribute("href")&&o.hasAttribute("tagged")&&"stylesheet"===o.getAttribute("rel").toLowerCase().trim()&&(c[t].setAttribute("tagged",r("tagged")),fetch(o.getAttribute("href")).then(t=>t.text()).then(t=>{e[o.getAttribute("tagged")]=s(t)}))}const l=document.querySelectorAll("input");for(let e=0;e<l.length;e++){const r=l[e];if(r.hasAttribute("tagged")){const e=r.getAttribute("tagged");t.store[e]&&(r.value=t.store[e],r.onkeyup=(s=>{t.store[e]=r.value}))}}const g=t=>{for(const[r,s]of Object.entries(e))for(let e=0;e<document.styleSheets.length;e++){const n=document.styleSheets[e];if(n.ownerNode&&n.ownerNode.getAttribute("tagged")===r)for(let e=0;e<n.cssRules.length;e++){const r=n.cssRules[e];s.forEach(s=>{if(s===r.selectorText)for(const[s,c]of Object.entries(r.style))if(c.trim().startsWith("--"))for(const[s,l]of Object.entries(t))if(s&&l){const t=r.style.getPropertyValue(c);if(`%${s.trim()}`===t.trim()){const t=o(c.split("--")[1].trim());n.cssRules[e].style[t.trim()]=l.trim()}}})}}};g(t.store),Object.keys(t.store).forEach(e=>{Object.defineProperty(t.store,e,{set:r=>{newStore={...t.store},newStore[e]=r,g(newStore)}})})};